---
title: "Multisequence alighment"
author: "Rafael Villasmil"
date: "10/16/2021"
output: pdf_document
---

```{r install-packages, echo=FALSE}
install.packages("ape")
install.packages("seqinr")
```

```{r load-packages}
library(ape)
#library(seqinr)
library(Biostrings)
library(msa)
```

```{r read-fasta-files-from-ncbi}
```

```{r load_seq_of_paper_species}
setwd("~/GitHub/cd4-aligment-nj/speciens _in_paper")
cd4_stringset_paper <- readDNAStringSet(list.files(pattern = "fa"))
cd4_stringset_paper <- readDNAStringSet(list.files(pattern = "fa"))
cd4_stringset_paper@ranges@NAMES
cd4_stringset_paper@ranges@width
cd4_ClustalW_paper <- msa(cd4_stringset_paper, method="ClustalW") 
working_clustalW <- cd4_ClustalW_paper
rownames(working_clustalW) <- c( "Mouse","Norway rat", "Human","Chimpanzee", "Rhesus monkey","Pig","Cattle", "Dog","Rabbit", "Chicken")
autoMasked <- maskGaps(working_clustalW, min.fraction=0.5, min.block.width=4)
sdist <- stringDist(as(autoMasked,"DNAStringSet"), method="hamming")
cd4_nj <- nj(sdist)
plot(cd4_nj)
```


```{r explore cd4_ClustalW}
rownames(cd4_ClustalW)
rownames(working_clustalW) <- c("Human", "Chimpanzee", "Rhesus monkey", 
                                "Green Monkey", "Cat", "Dog", "Mouse",
                                "Norway rat", "Pig", "Cattle")
detail(cd4_ClustalW)
maskTest <- cd4_ClustalW
rowmask(maskTest) <- IRanges(start=1,end=3)
rowmask(maskTest)
maskTest
```

use Multiple Aligment Objects 
```{r distance_matrix_calculation}
autoMasked <- maskGaps(working_clustalW, min.fraction=0.5, min.block.width=4)
sdist <- stringDist(as(autoMasked,"DNAStringSet"), method="hamming")


clust <- hclust(sdist, method = "single")
plot(clust)

cd4_nj <- nj(sdist)
plot(cd4_nj)
```

```{r}
library(stats)
library(ade4)
library(ape)
library(adegenet)
library(phangorn)

cd4_seq <- c(list.files(pattern = "fa"))
cd4_dna <- read.dna(cd4_stringset)
```

